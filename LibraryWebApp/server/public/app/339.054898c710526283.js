"use strict";(self.webpackChunklibrary=self.webpackChunklibrary||[]).push([[339],{3339:(L,p,d)=>{d.r(p),d.d(p,{AdminModule:()=>Y});var c=d(9808),n=d(2382),m=d(3902),g=d(5935);class f{constructor(){this._id="",this.name=""}}class b{constructor(){this._id="",this.name=""}}var e=d(1223),v=d(520),A=d(2468),I=d(7556),Z=d(639),_=d(4917);function T(r,o){1&r&&(e.TgZ(0,"span"),e._uU(1,"Field is required"),e.qZA())}function C(r,o){if(1&r&&(e.TgZ(0,"div"),e.YNc(1,T,2,0,"span",4),e.qZA()),2&r){const t=e.oxw();let i;e.xp6(1),e.Q6J("ngIf",null==(i=t.addForm.get("title"))||null==i.errors?null:i.errors.required)}}function q(r,o){1&r&&(e.TgZ(0,"span"),e._uU(1,"Field is required"),e.qZA())}function x(r,o){if(1&r&&(e.TgZ(0,"div"),e.YNc(1,q,2,0,"span",4),e.qZA()),2&r){const t=e.oxw();let i;e.xp6(1),e.Q6J("ngIf",null==(i=t.addForm.get("authorId"))||null==i.errors?null:i.errors.required)}}function F(r,o){1&r&&(e.TgZ(0,"span"),e._uU(1,"Field is required"),e.qZA())}function w(r,o){if(1&r&&(e.TgZ(0,"div"),e.YNc(1,F,2,0,"span",4),e.qZA()),2&r){const t=e.oxw();let i;e.xp6(1),e.Q6J("ngIf",null==(i=t.addForm.get("edition"))||null==i.errors?null:i.errors.required)}}function k(r,o){1&r&&(e.TgZ(0,"span"),e._uU(1,"Field is required"),e.qZA())}function U(r,o){if(1&r&&(e.TgZ(0,"div"),e.YNc(1,k,2,0,"span",4),e.qZA()),2&r){const t=e.oxw();let i;e.xp6(1),e.Q6J("ngIf",null==(i=t.addForm.get("publisherId"))||null==i.errors?null:i.errors.required)}}function N(r,o){1&r&&(e.TgZ(0,"span"),e._uU(1,"Field is required"),e.qZA())}function S(r,o){if(1&r&&(e.TgZ(0,"div"),e.YNc(1,N,2,0,"span",4),e.qZA()),2&r){const t=e.oxw();let i;e.xp6(1),e.Q6J("ngIf",null==(i=t.addForm.get("genreId"))||null==i.errors?null:i.errors.required)}}const J=[{path:"",component:(()=>{class r{constructor(t,i,s,l,u,a,h){this.http=t,this.dataService=i,this.auth=s,this.route=l,this.router=u,this.booksService=a,this.classificationService=h,this.user=null,this.editValue=-1,this.addValue=!1,this.knjige=[],this.bookSubject=null,this.subscription=null,this.genres=[],this.genreSubject=null,this.subscription3=null,this.publishers=[],this.publisherSubject=null,this.subscription4=null,this.new=new g.f,this.errorMessage="",this.errorMessage2="",this.submitted=!1,this.query="",this.query2="",this.bookClick=null}ngOnInit(){this.user=this.auth.getUser(),this.bookSubject=this.booksService.getBooks(),this.subscription=this.bookSubject.subscribe(t=>{console.log(t),this.knjige=t},t=>{console.log(t)}),this.genreSubject=this.classificationService.getGenres(),this.subscription3=this.genreSubject.subscribe(t=>{console.log(t),this.genres=t},t=>{console.log(t)}),this.publisherSubject=this.classificationService.getPublishers(),this.subscription4=this.publisherSubject.subscribe(t=>{console.log(t),this.publishers=t},t=>{console.log(t)}),this.addForm=new n.cw({title:new n.NI("",[n.kI.required]),authorId:new n.NI("",[n.kI.required]),edition:new n.NI("",[n.kI.required]),publisherId:new n.NI("",[n.kI.required]),genreId:new n.NI("",[n.kI.required])}),this.booksService.responseEmitter.subscribe(t=>{this.errorMessage=t,setTimeout(()=>{this.errorMessage=""},2500)}),this.classificationService.responseEmitter.subscribe(t=>{this.errorMessage2=this.errorMessage2+t+"\n",setTimeout(()=>{this.errorMessage2=""},2500)})}checkIfGenreExists(t){if(this.genres.filter(s=>s.name.toLowerCase()==t.toLowerCase().trim()).length>0)return!0;{let s=new f;return s.name=t,this.classificationService.addGenre(s),!1}}checkIfPublisherExists(t){if(this.publishers.filter(s=>s.name.toLowerCase()==t.toLowerCase().trim()).length>0)return!0;{let s=new b;return s.name=t,this.classificationService.addPublisher(s),!1}}genreIdToName(t){return this.genres.filter(s=>s._id==t).map(s=>s.name)}publisherIdToName(t){return this.publishers.filter(s=>s._id==t).map(s=>s.name)}onAddBook(){if(this.submitted=!0,this.addForm.invalid)return;this.new=this.addForm.value;let t=this.checkIfGenreExists(this.addForm.value.genreId);if(t){let s=this.genres.filter(l=>l.name.toLowerCase()==this.addForm.value.genreId.toLowerCase().trim());this.new.genreId=s[0]._id}else setTimeout(()=>{if(!t){let s=this.genres.filter(l=>l.name.toLowerCase()==this.addForm.value.genreId.toLowerCase().trim());this.new.genreId=s[0]._id}},2e3);let i=this.checkIfPublisherExists(this.addForm.value.publisherId);if(i){let s=this.publishers.filter(l=>l.name.toLowerCase()==this.addForm.value.publisherId.toLowerCase().trim());this.new.publisherId=s[0]._id}else setTimeout(()=>{if(!i){let s=this.publishers.filter(l=>l.name.toLowerCase()==this.addForm.value.publisherId.toLowerCase().trim());this.new.publisherId=s[0]._id}},4e3);setTimeout(()=>{this.booksService.addBook(this.new),this.new={_id:"",title:"",authorId:"",edition:0,publisherId:"",genreId:""}},6e3)}backToDashboard(){this.router.navigate([""])}}return r.\u0275fac=function(t){return new(t||r)(e.Y36(v.eN),e.Y36(A.D),e.Y36(I.e),e.Y36(m.gz),e.Y36(m.F0),e.Y36(Z.y),e.Y36(_.c))},r.\u0275cmp=e.Xpm({type:r,selectors:[["app-admin"]],decls:54,vars:11,consts:[["fxLayout","column","fxLayoutAlign","center center",3,"formGroup","submit"],[1,"form-group"],["for","title"],["type","text","formControlName","title","placeholder","Title","id","title",1,"form-control"],[4,"ngIf"],["for","authorId"],["type","text","formControlName","authorId","placeholder","Author","id","authorId",1,"form-control"],["for","edition"],["type","number","formControlName","edition","id","edition",1,"form-control"],["for","publisherId"],["type","text","formControlName","publisherId","placeholder","Publisher","id","publisherId",1,"form-control"],["for","genreId"],["type","text","formControlName","genreId","placeholder","Genre","id","genreId",1,"form-control"],[3,"ngClass"],["type","submit",1,"btn","btn-success",3,"disabled"],[1,"btn","btn-link",3,"click"]],template:function(t,i){if(1&t&&(e.TgZ(0,"div")(1,"h1"),e._uU(2,"Add Book"),e.qZA()(),e.TgZ(3,"form",0),e.NdJ("submit",function(){return i.onAddBook()}),e.TgZ(4,"fieldset",1)(5,"div")(6,"label",2),e._uU(7,"Title"),e.qZA(),e._UZ(8,"br")(9,"input",3),e.qZA(),e.YNc(10,C,2,1,"div",4),e.qZA(),e._UZ(11,"br"),e.TgZ(12,"fieldset",1)(13,"div")(14,"label",5),e._uU(15,"Author"),e.qZA(),e._UZ(16,"br")(17,"input",6),e.qZA(),e.YNc(18,x,2,1,"div",4),e.qZA(),e._UZ(19,"br"),e.TgZ(20,"fieldset",1)(21,"div")(22,"label",7),e._uU(23,"Edition"),e.qZA(),e._UZ(24,"br")(25,"input",8),e.qZA(),e.YNc(26,w,2,1,"div",4),e.qZA(),e._UZ(27,"br"),e.TgZ(28,"fieldset",1)(29,"div")(30,"label",9),e._uU(31,"Publisher"),e.qZA(),e._UZ(32,"br")(33,"input",10),e.qZA(),e.YNc(34,U,2,1,"div",4),e.qZA(),e._UZ(35,"br"),e.TgZ(36,"fieldset",1)(37,"div")(38,"label",11),e._uU(39,"Genre"),e.qZA(),e._UZ(40,"br")(41,"input",12),e.qZA(),e.YNc(42,S,2,1,"div",4),e.qZA(),e._UZ(43,"br"),e.TgZ(44,"h4",13),e._uU(45),e.qZA(),e.TgZ(46,"h4",13),e._uU(47),e.qZA(),e.TgZ(48,"button",14),e._uU(49,"Add book!"),e.qZA(),e._UZ(50,"br")(51,"br"),e.TgZ(52,"button",15),e.NdJ("click",function(){return i.backToDashboard()}),e._uU(53,"Back"),e.qZA()()),2&t){let s,l,u,a,h;e.xp6(3),e.Q6J("formGroup",i.addForm),e.xp6(7),e.Q6J("ngIf",(null==(s=i.addForm.get("title"))?null:s.invalid)&&(null==(s=i.addForm.get("title"))?null:s.touched)),e.xp6(8),e.Q6J("ngIf",(null==(l=i.addForm.get("authorId"))?null:l.invalid)&&(null==(l=i.addForm.get("authorId"))?null:l.touched)),e.xp6(8),e.Q6J("ngIf",(null==(u=i.addForm.get("edition"))?null:u.invalid)&&(null==(u=i.addForm.get("edition"))?null:u.touched)),e.xp6(8),e.Q6J("ngIf",(null==(a=i.addForm.get("publisherId"))?null:a.invalid)&&(null==(a=i.addForm.get("publisherId"))?null:a.touched)),e.xp6(8),e.Q6J("ngIf",(null==(h=i.addForm.get("genreId"))?null:h.invalid)&&(null==(h=i.addForm.get("genreId"))?null:h.touched)),e.xp6(2),e.Q6J("ngClass",i.errorMessage.includes("unsuccessful")?"text-danger":"text-success"),e.xp6(1),e.Oqu(i.errorMessage),e.xp6(1),e.Q6J("ngClass",i.errorMessage2.includes("unsuccessful")?"text-danger":"text-success"),e.xp6(1),e.Oqu(i.errorMessage2),e.xp6(1),e.Q6J("disabled",i.addForm.invalid)}},directives:[n._Y,n.JL,n.sg,n.Fj,n.JJ,n.u,c.O5,n.wV,c.mk],styles:[""]}),r})()}];let y=(()=>{class r{}return r.\u0275fac=function(t){return new(t||r)},r.\u0275mod=e.oAB({type:r}),r.\u0275inj=e.cJS({imports:[[m.Bz.forChild(J)],m.Bz]}),r})();var M=d(6378);let Y=(()=>{class r{}return r.\u0275fac=function(t){return new(t||r)},r.\u0275mod=e.oAB({type:r}),r.\u0275inj=e.cJS({imports:[[c.ez,n.u5,n.UX,y,M.DashboardModule]]}),r})()}}]);