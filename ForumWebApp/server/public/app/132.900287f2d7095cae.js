"use strict";(self.webpackChunklab5=self.webpackChunklab5||[]).push([[132],{132:(q,g,c)=>{c.r(g),c.d(g,{ForumModule:()=>y});var d=c(9808),u=c(2382),l=c(3902);class x{constructor(){this._id="",this.userId="",this.timeStamp="",this.comment=""}}var t=c(1223),a=c(520),p=c(1502),m=c(2891),b=c(1135);let f=(()=>{class i{constructor(e,o){this.http=e,this.dataService=o,this.posts=[],this.postSubject=new b.X([]),this.init()}init(){this.dataService.getPosts().subscribe(e=>{this.posts=e,this.postSubject.next([...this.posts])})}getPosts(){return this.postSubject}addPost(e){this.dataService.addPost(e).subscribe(o=>{console.log(o),e._id=o.toString(),this.posts.push(e),this.postSubject.next(this.posts)})}deletePost(e){this.dataService.deletePost(e).subscribe(o=>{console.log(o),this.posts=this.posts.filter(n=>n._id!=e),this.postSubject.next(this.posts)})}editPost(e){this.dataService.editPost(e).subscribe(o=>{console.log(o),this.posts[this.posts.findIndex(n=>n._id==e._id)]=e,this.postSubject.next(this.posts)},o=>{console.log(o)})}}return i.\u0275fac=function(e){return new(e||i)(t.LFG(a.eN),t.LFG(p.D))},i.\u0275prov=t.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();var Z=c(474);function k(i,s){if(1&i){const e=t.EpF();t.TgZ(0,"div")(1,"button",3),t.NdJ("click",function(){t.CHM(e);const n=t.oxw(2).$implicit;return t.oxw(2).onDelete(n._id)}),t._uU(2,"Delete"),t.qZA(),t.TgZ(3,"button",7),t.NdJ("click",function(){t.CHM(e);const n=t.oxw(2).$implicit;return t.oxw(2).startEditing(n)}),t._uU(4,"Edit"),t.qZA()()}}function T(i,s){if(1&i&&(t.TgZ(0,"div")(1,"span"),t._uU(2),t._UZ(3,"hr"),t.qZA(),t.YNc(4,k,5,0,"div",0),t.qZA()),2&i){const e=t.oxw().$implicit,o=t.oxw(2);t.xp6(2),t.Oqu(e.comment),t.xp6(2),t.Q6J("ngIf",e.userId==o.user._id)}}function C(i,s){if(1&i){const e=t.EpF();t.TgZ(0,"div")(1,"textarea",8,9),t._uU(3),t.qZA(),t._UZ(4,"br"),t.TgZ(5,"button",3),t.NdJ("click",function(){t.CHM(e);const n=t.oxw().$implicit;return t.oxw(2).onDelete(n._id)}),t._uU(6,"Delete"),t.qZA(),t.TgZ(7,"button",7),t.NdJ("click",function(){t.CHM(e);const n=t.MAs(2),r=t.oxw().$implicit;return t.oxw(2).onEdit(r,n)}),t._uU(8,"Done editing"),t.qZA(),t._UZ(9,"br")(10,"br"),t.TgZ(11,"button",3),t.NdJ("click",function(){return t.CHM(e),t.oxw(3).editValue=-1}),t._uU(12,"Cancel"),t.qZA()()}if(2&i){const e=t.oxw().$implicit;t.xp6(3),t.Oqu(e.comment)}}function F(i,s){if(1&i&&(t.TgZ(0,"div",6),t._uU(1),t._UZ(2,"hr"),t.YNc(3,T,5,2,"div",0),t.YNc(4,C,13,1,"div",0),t.qZA()),2&i){const e=s.$implicit,o=t.oxw(2);t.xp6(1),t.AsE(" By ",o.userIdToUsername(e.userId)," at ",e.timeStamp,""),t.xp6(2),t.Q6J("ngIf",o.editValue!=o.komentari.indexOf(e)),t.xp6(1),t.Q6J("ngIf",o.editValue==o.komentari.indexOf(e))}}function S(i,s){if(1&i){const e=t.EpF();t.TgZ(0,"div")(1,"button",7),t.NdJ("click",function(){return t.CHM(e),t.oxw(2).startAdding()}),t._uU(2,"Add New Post"),t.qZA()()}}function U(i,s){if(1&i){const e=t.EpF();t.TgZ(0,"div")(1,"button",3),t.NdJ("click",function(){return t.CHM(e),t.oxw(2).onCancel()}),t._uU(2,"Cancel"),t.qZA(),t._UZ(3,"br"),t.TgZ(4,"label"),t._uU(5,"User:"),t.qZA(),t._UZ(6,"br")(7,"input",10)(8,"br"),t.TgZ(9,"label"),t._uU(10,"Comment:"),t.qZA(),t._UZ(11,"br"),t.TgZ(12,"textarea",11),t.NdJ("ngModelChange",function(n){return t.CHM(e),t.oxw(2).new.comment=n}),t.qZA(),t._UZ(13,"br"),t.TgZ(14,"button",12),t.NdJ("click",function(){t.CHM(e);const n=t.oxw(2);return n.addPost(n.user._id)}),t._uU(15,"Send"),t.qZA()()}if(2&i){const e=t.oxw(2);t.xp6(7),t.s9C("value",e.user.username),t.xp6(5),t.Q6J("ngModel",e.new.comment),t.xp6(2),t.Q6J("disabled",0==e.new.comment.length)}}function w(i,s){if(1&i){const e=t.EpF();t.TgZ(0,"div")(1,"p",1),t._uU(2,"Welcome, "),t.TgZ(3,"a",2),t.NdJ("click",function(){return t.CHM(e),t.oxw().profile()}),t._uU(4),t.qZA(),t._uU(5),t.qZA(),t.TgZ(6,"button",3),t.NdJ("click",function(){return t.CHM(e),t.oxw().logout()}),t._uU(7,"Logout"),t.qZA(),t.TgZ(8,"div")(9,"h1"),t._uU(10),t.qZA()(),t.TgZ(11,"div",4),t.YNc(12,F,5,4,"div",5),t.qZA(),t._UZ(13,"br"),t.TgZ(14,"div"),t.YNc(15,S,3,0,"div",0),t.YNc(16,U,16,3,"div",0),t.qZA()()}if(2&i){const e=t.oxw();t.xp6(4),t.Oqu(e.user.username),t.xp6(1),t.hij(" (",e.user.email,")"),t.xp6(5),t.hij("Posts (",e.komentari.length,"):"),t.xp6(2),t.Q6J("ngForOf",e.komentari),t.xp6(3),t.Q6J("ngIf",0==e.addValue),t.xp6(1),t.Q6J("ngIf",1==e.addValue)}}function P(i,s){if(1&i&&(t.TgZ(0,"div",7),t._uU(1),t._UZ(2,"hr"),t.TgZ(3,"div"),t._uU(4),t._UZ(5,"hr"),t.qZA()()),2&i){const e=s.$implicit,o=t.oxw(2);t.xp6(1),t.AsE(" By ",o.user.username," at ",e.timeStamp,""),t.xp6(3),t.hij(" ",e.comment,"")}}function j(i,s){if(1&i&&(t.TgZ(0,"div")(1,"div",2)(2,"div",3)(3,"p"),t._uU(4),t.qZA(),t.TgZ(5,"div",4),t.YNc(6,P,6,3,"div",5),t.qZA()(),t.TgZ(7,"div",6)(8,"p"),t._uU(9,"User data:"),t.qZA(),t.TgZ(10,"p"),t._uU(11),t.qZA(),t.TgZ(12,"p"),t._uU(13),t.qZA(),t.TgZ(14,"p"),t._uU(15),t.qZA()()()()),2&i){const e=t.oxw();t.xp6(4),t.AsE("Posts by ",e.user.username," (",e.komentari.length,")"),t.xp6(2),t.Q6J("ngForOf",e.komentari),t.xp6(5),t.hij("Username: ",e.user.username,""),t.xp6(2),t.hij("E-mail: ",e.user.email,""),t.xp6(2),t.hij("Name: ",e.user.name,"")}}const J=[{path:"",component:(()=>{class i{constructor(e,o,n,r,_,h,v){this.http=e,this.dataService=o,this.auth=n,this.route=r,this.router=_,this.postsService=h,this.usersService=v,this.user=null,this.editValue=-1,this.addValue=!1,this.korisnici=[],this.komentari=[],this.postSubject=null,this.subscription=null,this.userSubject=null,this.subscription2=null,this.new=new x}ngOnInit(){this.user=this.auth.getUser(),this.postSubject=this.postsService.getPosts(),this.subscription=this.postSubject.subscribe(e=>{console.log(e),this.komentari=e},e=>{console.log(e)}),this.userSubject=this.usersService.getUsers(),this.subscription2=this.userSubject.subscribe(e=>{console.log(e),this.korisnici=e},e=>{console.log(e)})}userIdToUsername(e){return this.korisnici.length<1&&(this.userSubject=this.usersService.getUsers(),this.subscription2=this.userSubject.subscribe(n=>{console.log(n),this.korisnici=n},n=>{console.log(n)})),this.korisnici.filter(n=>n._id==e).map(n=>n.username)}onCancel(){this.addValue=!this.addValue,this.new.comment=""}addPost(e){console.log(this.new),this.new.userId=e,this.new.timeStamp=(new Date).toLocaleString(),this.addValue=!1,this.postsService.addPost(this.new),this.new={_id:"",userId:"",timeStamp:"",comment:""}}startEditing(e){this.editValue=this.komentari.indexOf(e)}startAdding(){this.addValue=!this.addValue,this.editValue=-1}onEdit(e,o){this.editValue=-1,e.comment=o.value,this.postsService.editPost(e)}onDelete(e){this.editValue=-1,console.log(e),this.postsService.deletePost(e)}profile(){this.router.navigate(["profile"])}logout(){this.auth.logout()}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(a.eN),t.Y36(p.D),t.Y36(m.e),t.Y36(l.gz),t.Y36(l.F0),t.Y36(f),t.Y36(Z.f))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-forum"]],decls:1,vars:1,consts:[[4,"ngIf"],[2,"padding","0.375rem"],[2,"text-decoration","underline","color","blue",3,"click"],[1,"btn","btn-danger",3,"click"],[2,"background-color","indianred","padding","5px"],["class","well","style","width:400px; padding: 5px; margin:5px; background-color: aliceblue",4,"ngFor","ngForOf"],[1,"well",2,"width","400px","padding","5px","margin","5px","background-color","aliceblue"],[1,"btn","btn-warning",3,"click"],["rows","4","cols","50"],["editirani",""],["type","text","disabled","",3,"value"],["rows","4","cols","50",3,"ngModel","ngModelChange"],["id","addBtn",1,"btn","btn-success",3,"disabled","click"]],template:function(e,o){1&e&&t.YNc(0,w,17,6,"div",0),2&e&&t.Q6J("ngIf",o.user&&o.user.username)},directives:[d.O5,d.sg,u.Fj,u.JJ,u.On],styles:["a[_ngcontent-%COMP%]:hover{cursor:pointer}"]}),i})()},{path:"profile",component:(()=>{class i{constructor(e,o,n,r,_,h,v){this.http=e,this.dataService=o,this.auth=n,this.route=r,this.router=_,this.postsService=h,this.fb=v,this.user=null,this.komentari=[],this.postSubject=null,this.subscription=null}ngOnInit(){this.user=this.auth.getUser(),this.postSubject=this.postsService.getPosts(),this.subscription=this.postSubject.subscribe(e=>{console.log(e),this.komentari=e.filter(o=>{var n;return o.userId==(null===(n=this.user)||void 0===n?void 0:n._id)})},e=>{console.log(e)})}back(){this.router.navigate(["/"])}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(a.eN),t.Y36(p.D),t.Y36(m.e),t.Y36(l.gz),t.Y36(l.F0),t.Y36(f),t.Y36(u.qu))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-profile"]],decls:3,vars:1,consts:[[4,"ngIf"],[1,"btn","btn-link",3,"click"],[1,"row"],[1,"col-sm-8",2,"padding-top","2rem"],[1,"card",2,"background-color","indianred","padding","5px"],["class","well","style","width:400px; padding: 5px; margin:5px; background-color: aliceblue",4,"ngFor","ngForOf"],[1,"col-sm-4",2,"padding-top","2rem"],[1,"well",2,"width","400px","padding","5px","margin","5px","background-color","aliceblue"]],template:function(e,o){1&e&&(t.YNc(0,j,16,6,"div",0),t.TgZ(1,"button",1),t.NdJ("click",function(){return o.back()}),t._uU(2,"Back"),t.qZA()),2&e&&t.Q6J("ngIf",o.user&&o.user.username)},directives:[d.O5,d.sg],styles:[""]}),i})()}];let N=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=t.oAB({type:i}),i.\u0275inj=t.cJS({imports:[[l.Bz.forChild(J)],l.Bz]}),i})();var M=c(262),Y=c(2843);let I=(()=>{class i{constructor(e){this.authService=e}intercept(e,o){const n=this.authService.getToken();return n&&(e=e.clone({setHeaders:{Authorization:`Authorization token ${n}`}})),o.handle(e).pipe((0,M.K)(r=>(0,Y._)(r)))}}return i.\u0275fac=function(e){return new(e||i)(t.LFG(m.e))},i.\u0275prov=t.Yz7({token:i,factory:i.\u0275fac}),i})(),y=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=t.oAB({type:i}),i.\u0275inj=t.cJS({providers:[{provide:a.TP,useClass:I,multi:!0}],imports:[[d.ez,u.u5,u.UX,N]]}),i})()}}]);